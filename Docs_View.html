<!DOCTYPE html>
<html>

<head>
  <base target="_top">
  <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/marked@4.3.0/marked.min.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github-dark.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
  <style>
    :root {
      --primary-color: #2E7D32;
      --secondary-color: #4CAF50;
      --bg-color: #F8F9FA;
      --text-color: #333;
      --sidebar-width: 280px;
    }

    body {
      font-family: 'Sarabun', sans-serif;
      margin: 0;
      padding: 0;
      display: flex;
      height: 100vh;
      background-color: var(--bg-color);
      color: var(--text-color);
      overflow: hidden;
    }

    /* Sidebar */
    .sidebar {
      width: var(--sidebar-width);
      background: white;
      border-right: 1px solid #ddd;
      display: flex;
      flex-direction: column;
      height: 100%;
      box-shadow: 2px 0 5px rgba(0, 0, 0, 0.05);
      z-index: 10;
    }

    .sidebar-header {
      padding: 20px;
      border-bottom: 1px solid #eee;
      background: var(--primary-color);
      color: white;
    }

    .sidebar-header h2 {
      margin: 0;
      font-size: 1.2rem;
      font-weight: 600;
    }

    .nav-list {
      flex: 1;
      overflow-y: auto;
      padding: 10px 0;
    }

    .nav-item {
      padding: 12px 20px;
      cursor: pointer;
      display: flex;
      align-items: center;
      transition: all 0.2s;
      font-weight: 500;
      color: #555;
      border-left: 4px solid transparent;
    }

    .nav-item:hover {
      background-color: #f0f7f1;
      color: var(--primary-color);
    }

    .nav-item.active {
      background-color: #e8f5e9;
      color: var(--primary-color);
      border-left-color: var(--primary-color);
    }

    .nav-icon {
      margin-right: 10px;
      font-size: 1.2rem;
      width: 24px;
      text-align: center;
    }

    /* Main Content */
    .main-content {
      flex: 1;
      padding: 40px;
      overflow-y: auto;
      background: white;
      max-width: 1000px;
      margin: 0 auto;
      box-shadow: 0 0 20px rgba(0, 0, 0, 0.05);
    }

    /* Markdown Styles */
    .markdown-body {
      line-height: 1.8;
      font-size: 16px;
    }

    .markdown-body h1,
    .markdown-body h2,
    .markdown-body h3 {
      color: var(--primary-color);
      margin-top: 1.5em;
      margin-bottom: 0.5em;
      font-weight: 600;
    }

    .markdown-body h1 {
      font-size: 2.2rem;
      border-bottom: 2px solid #eee;
      padding-bottom: 10px;
    }

    .markdown-body h2 {
      font-size: 1.8rem;
    }

    .markdown-body p {
      margin-bottom: 1em;
      color: #444;
    }

    .markdown-body ul,
    .markdown-body ol {
      padding-left: 25px;
      margin-bottom: 1em;
    }

    .markdown-body li {
      margin-bottom: 0.5em;
    }

    .markdown-body code {
      background-color: #f5f5f5;
      padding: 2px 6px;
      border-radius: 4px;
      font-family: 'Consolas', monospace;
      font-size: 0.9em;
      color: #d63384;
    }

    .markdown-body pre {
      background-color: #1e1e1e;
      padding: 15px;
      border-radius: 8px;
      overflow-x: auto;
      margin: 1.5em 0;
    }

    .markdown-body pre code {
      background-color: transparent;
      color: #f8f8f2;
      padding: 0;
    }

    .markdown-body blockquote {
      border-left: 4px solid var(--secondary-color);
      margin: 1.5em 0;
      padding: 10px 20px;
      background-color: #f9f9f9;
      color: #666;
      font-style: italic;
    }

    .markdown-body table {
      width: 100%;
      border-collapse: collapse;
      margin: 1.5em 0;
      background: white;
      border-radius: 8px;
      overflow: hidden;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    }

    .markdown-body th,
    .markdown-body td {
      padding: 12px 15px;
      border-bottom: 1px solid #eee;
      text-align: left;
    }

    .markdown-body th {
      background-color: var(--primary-color);
      color: white;
      font-weight: 600;
    }

    .markdown-body tr:hover {
      background-color: #f5f5f5;
    }

    .markdown-body img {
      max-width: 100%;
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      margin: 1em 0;
    }

    /* Scrollbar */
    ::-webkit-scrollbar {
      width: 8px;
      height: 8px;
    }

    ::-webkit-scrollbar-track {
      background: #f1f1f1;
    }

    ::-webkit-scrollbar-thumb {
      background: #ccc;
      border-radius: 4px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: #aaa;
    }
  </style>
</head>

<body>

  <!-- Sidebar -->
  <div class="sidebar">
    <div class="sidebar-header">
      <h2>üìö ‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</h2>
    </div>
    <div class="nav-list">
      <div class="nav-item active" onclick="showDoc('overview')">
        <span class="nav-icon">üè†</span> ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏£‡∏∞‡∏ö‡∏ö
      </div>
      <div class="nav-item" onclick="showDoc('user-manual')">
        <span class="nav-icon">üìñ</span> ‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ
      </div>
      <div class="nav-item" onclick="showDoc('dev-guide')">
        <span class="nav-icon">üõ†Ô∏è</span> ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ô‡∏±‡∏Å‡∏û‡∏±‡∏í‡∏ô‡∏≤
      </div>
      <div class="nav-item" onclick="showDoc('system')">
        <span class="nav-icon">‚öôÔ∏è</span> ‡∏£‡∏∞‡∏ö‡∏ö & ‡∏™‡∏ñ‡∏≤‡∏õ‡∏±‡∏ï‡∏¢‡∏Å‡∏£‡∏£‡∏°
      </div>
    </div>
  </div>

  <!-- Main Content Area -->
  <div class="main-content">
    <div id="content" class="markdown-body">
      <!-- Content will be injected here -->
    </div>

    ## üöÄ ‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á

    ### ‚úÖ ‡∏Ç‡πâ‡∏≠‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô

    1. **Google Account** (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Apps Script)
    2. **Node.js** (v14 ‡∏Ç‡∏∂‡πâ‡∏ô‡πÑ‡∏õ)
    3. **Google Sheets** (2 ‡∏ä‡∏µ‡∏ó)
    4. **API Keys** (‡∏ñ‡πâ‡∏≤‡πÉ‡∏ä‡πâ AI)

    ### üì¶ ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á

    #### 1. ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á `clasp` CLI

    ```bash
    npm install -g @google/clasp
    ```

    #### 2. Login ‡πÄ‡∏Ç‡πâ‡∏≤ Google Account

    ```bash
    clasp login
    ```

    #### 3. ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Ñ Apps Script ‡πÉ‡∏´‡∏°‡πà

    ```bash
    # ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Ñ‡πÉ‡∏´‡∏°‡πà
    clasp create --type webapp --title "‡∏£‡∏∞‡∏ö‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡πâ‡∏≤‡∏ß"

    # ‡∏´‡∏£‡∏∑‡∏≠ clone ‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Ñ‡πÄ‡∏î‡∏¥‡∏° (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)
    clasp clone YOUR_SCRIPT_ID
    ```

    #### 4. ‡∏™‡∏£‡πâ‡∏≤‡∏á Google Sheets (2 ‡∏ä‡∏µ‡∏ó)

    **Sheet 1: ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏≤‡∏∞‡∏õ‡∏•‡∏π‡∏Å**
    - ‡∏ä‡∏∑‡πà‡∏≠: `DGA_rice_[‡∏ä‡∏∑‡πà‡∏≠‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î]_2568/69`
    - Headers:
    ```
    Timestamp ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å | ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô | ‡∏≠‡∏≥‡πÄ‡∏†‡∏≠ | ‡∏ï‡∏≥‡∏ö‡∏• | ‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå‡∏Ç‡πâ‡∏≤‡∏ß |
    ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏≤‡∏∞‡∏õ‡∏•‡∏π‡∏Å (‡πÑ‡∏£‡πà) | ‡∏ú‡∏•‡∏ú‡∏•‡∏¥‡∏ï‡∏ï‡πà‡∏≠‡πÑ‡∏£‡πà (‡∏Å‡∏Å.) | ‡πÄ‡∏Ç‡∏ï‡∏ä‡∏•‡∏õ‡∏£‡∏∞‡∏ó‡∏≤‡∏ô |
    ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß | ‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì‡∏ú‡∏•‡∏ú‡∏•‡∏¥‡∏ï (‡∏ï‡∏±‡∏ô) | ‡πÄ‡∏•‡∏Ç‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å
    ```

    **Sheet 2: ‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô**
    - ‡∏ä‡∏∑‡πà‡∏≠: `Feedback_Responses`
    - Headers:
    ```
    Timestamp | ‡∏î‡πâ‡∏≤‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏ß‡∏¢‡∏á‡∏≤‡∏° (UI) | ‡∏î‡πâ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô (UX) |
    ‡∏î‡πâ‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏ä‡∏ô‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• | ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢ | ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô |
    ‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°
    ```

    #### 5. ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Config

    ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÑ‡∏ü‡∏•‡πå `‡∏£‡∏´‡∏±‡∏™.js`:

    ```javascript
    const SPREADSHEET_ID = "YOUR_SHEET_ID_HERE";
    const SHEET_NAME = "DGA_rice_[‡∏ä‡∏∑‡πà‡∏≠‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î]_2568/69";
    ```

    ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÑ‡∏ü‡∏•‡πå `Feedback_Code.js`:

    ```javascript
    const FEEDBACK_SHEET_ID = "YOUR_FEEDBACK_SHEET_ID";
    ```

    ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÑ‡∏ü‡∏•‡πå `AI_Bot.gs.js`:

    ```javascript
    const SS_ID = "YOUR_SHEET_ID_HERE";
    ```

    #### 6. ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ API Keys (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö AI)

    ‡πÉ‡∏ô Apps Script Editor:
    1. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà **Project Settings** (‚öôÔ∏è)
    2. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å **Script Properties**
    3. ‡πÄ‡∏û‡∏¥‡πà‡∏° Properties:
    - `GEMINI_API_KEY` = [Your Gemini API Key]
    - `OPENWEATHER_API_KEY` = [Your OpenWeather API Key]

    #### 7. Deploy

    ```bash
    # Push ‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏Ç‡∏∂‡πâ‡∏ô Google
    clasp push

    # Deploy ‡πÄ‡∏õ‡πá‡∏ô Web App
    clasp deploy
    ```

    ---

    ## üîß ‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏á‡∏£‡∏∞‡∏ö‡∏ö

    ### üåç ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏≠‡∏∑‡πà‡∏ô

    #### 1. ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏≥‡πÄ‡∏†‡∏≠-‡∏ï‡∏≥‡∏ö‡∏•

    ‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå `‡∏£‡∏´‡∏±‡∏™.js`:

    ```javascript
    const districtsData = {
    "‡∏≠‡∏≥‡πÄ‡∏†‡∏≠ 1": ["‡∏ï‡∏≥‡∏ö‡∏• 1", "‡∏ï‡∏≥‡∏ö‡∏• 2", "‡∏ï‡∏≥‡∏ö‡∏• 3"],
    "‡∏≠‡∏≥‡πÄ‡∏†‡∏≠ 2": ["‡∏ï‡∏≥‡∏ö‡∏• 1", "‡∏ï‡∏≥‡∏ö‡∏• 2"],
    // ... ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ï‡∏≤‡∏°‡∏à‡∏£‡∏¥‡∏á
    };
    ```

    #### 2. ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ä‡∏∑‡πà‡∏≠ Sheet

    ```javascript
    const SHEET_NAME = "DGA_rice_[‡∏ä‡∏∑‡πà‡∏≠‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡πÉ‡∏´‡∏°‡πà]_2568/69";
    ```

    #### 3. ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏û‡∏¥‡∏Å‡∏±‡∏î‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏û‡∏¢‡∏≤‡∏Å‡∏£‡∏ì‡πå‡∏≠‡∏≤‡∏Å‡∏≤‡∏®

    ‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå `AI_Bot.gs.js`:

    ```javascript
    const DISTRICT_COORDS = {
    "‡∏≠‡∏≥‡πÄ‡∏†‡∏≠ 1": {lat: 13.690, lon: 101.070},
    "‡∏≠‡∏≥‡πÄ‡∏†‡∏≠ 2": {lat: 13.725, lon: 101.208},
    // ... ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏û‡∏¥‡∏Å‡∏±‡∏î‡∏Ç‡∏≠‡∏á‡∏≠‡∏≥‡πÄ‡∏†‡∏≠‡πÉ‡∏´‡∏°‡πà
    };
    ```

    #### 4. ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÉ‡∏ô UI

    ‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå `Index.html`:

    ```html
    <h1>‡∏£‡∏∞‡∏ö‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏≤‡∏∞‡∏õ‡∏•‡∏π‡∏Å‡∏Ç‡πâ‡∏≤‡∏ß</h1>
    <!-- ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô -->
    <h1>‡∏£‡∏∞‡∏ö‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏≤‡∏∞‡∏õ‡∏•‡∏π‡∏Å‡∏Ç‡πâ‡∏≤‡∏ß - ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î[‡∏ä‡∏∑‡πà‡∏≠‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î]</h1>
    ```

    ### üåæ ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏û‡∏∑‡∏ä‡∏≠‡∏∑‡πà‡∏ô

    #### 1. ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ä‡∏∑‡πà‡∏≠‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå

    ‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå `Index.html`:

    ```javascript
    // ‡∏à‡∏≤‡∏Å‡πÄ‡∏î‡∏¥‡∏°
    const RICE_VARIETIES = ["‡∏´‡∏≠‡∏°‡∏°‡∏∞‡∏•‡∏¥", "‡∏õ‡∏ó‡∏∏‡∏°‡∏ò‡∏≤‡∏ô‡∏µ", ...];

    // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô (‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á: ‡∏Ç‡πâ‡∏≤‡∏ß‡πÇ‡∏û‡∏î)
    const CORN_VARIETIES = ["‡∏Ç‡πâ‡∏≤‡∏ß‡πÇ‡∏û‡∏î‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á‡∏™‡∏±‡∏ï‡∏ß‡πå", "‡∏Ç‡πâ‡∏≤‡∏ß‡πÇ‡∏û‡∏î‡∏´‡∏ß‡∏≤‡∏ô", "‡∏Ç‡πâ‡∏≤‡∏ß‡πÇ‡∏û‡∏î‡πÄ‡∏ó‡∏µ‡∏¢‡∏ô‡∏ó‡∏≠‡∏á", ...];
    ```
    </script>

    <!-- 4. System & Architecture -->
    <script type="text/markdown" id="md-system">
# ‚öôÔ∏è ‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏•‡∏∞‡∏™‡∏ñ‡∏≤‡∏õ‡∏±‡∏ï‡∏¢‡∏Å‡∏£‡∏£‡∏°

## üìÅ ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå

```
DGA APPSCRIPTS/
‚îú‚îÄ‚îÄ ‡∏£‡∏´‡∏±‡∏™.js                    # üéØ Server-side ‡∏´‡∏•‡∏±‡∏Å (‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å/‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•)
‚îú‚îÄ‚îÄ Index.html                  # üåê ‡∏´‡∏ô‡πâ‡∏≤‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (Frontend)
‚îú‚îÄ‚îÄ AI_Bot.gs.js               # ü§ñ AI Analysis Engine
‚îú‚îÄ‚îÄ AI_View.html               # üìä ‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏• AI Report
‚îú‚îÄ‚îÄ Web_Player.js              # üéÆ Server ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö AI View
‚îú‚îÄ‚îÄ Feedback_Code.js           # üìù Server-side ‡∏Ç‡∏≠‡∏á‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô
‚îú‚îÄ‚îÄ Feedback_Form.html         # üìã ‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à
‚îú‚îÄ‚îÄ RateLimiter.js            # üõ°Ô∏è ‡∏£‡∏∞‡∏ö‡∏ö Rate Limiting
‚îú‚îÄ‚îÄ appsscript.json           # ‚öôÔ∏è Config ‡∏´‡∏•‡∏±‡∏Å
‚îî‚îÄ‚îÄ README.md                  # üìö ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ô‡∏µ‡πâ
```

---

## ‚öôÔ∏è ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Rate Limiting

### ‡∏õ‡∏£‡∏±‡∏ö‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≤‡∏£‡∏à‡∏≥‡∏Å‡∏±‡∏î

‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå `RateLimiter.js`:

```javascript
const RATE_LIMITS = {
  SAVE_DATA: {
    global: { max: 200, window: 3600 },   // 200 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á/‡∏ä‡∏°. ‡∏ó‡∏±‡πâ‡∏á‡∏£‡∏∞‡∏ö‡∏ö
    session: { max: 30, window: 86400 }   // 30 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á/‡∏ß‡∏±‡∏ô ‡∏ï‡πà‡∏≠ session
  },
  // ... ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏ï‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£
};
```

**‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥:**
- ‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£‡∏Ç‡∏ô‡∏≤‡∏î‡πÄ‡∏•‡πá‡∏Å (< 50 ‡∏Ñ‡∏ô): ‡πÄ‡∏û‡∏¥‡πà‡∏° session limit ‡πÄ‡∏õ‡πá‡∏ô 50-100
- ‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£‡∏Ç‡∏ô‡∏≤‡∏î‡πÉ‡∏´‡∏ç‡πà (> 200 ‡∏Ñ‡∏ô): ‡πÄ‡∏û‡∏¥‡πà‡∏° global limit ‡πÄ‡∏õ‡πá‡∏ô 500-1000
- ‡∏ñ‡πâ‡∏≤‡πÉ‡∏ä‡πâ AI ‡∏ö‡πà‡∏≠‡∏¢: ‡πÄ‡∏û‡∏¥‡πà‡∏° GEMINI_API limit

---

## üìä ‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Dashboard

### Looker Studio Setup

1. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà https://lookerstudio.google.com/
2. Create ‚Üí Data Source ‚Üí Google Sheets
3. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Sheet ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
4. ‡∏™‡∏£‡πâ‡∏≤‡∏á Report ‡πÅ‡∏•‡∏∞‡πÄ‡∏û‡∏¥‡πà‡∏° Charts:
   - **Line Chart**: ‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏≤‡∏∞‡∏õ‡∏•‡∏π‡∏Å‡∏ï‡∏≤‡∏°‡πÄ‡∏ß‡∏•‡∏≤
   - **Bar Chart**: ‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏ú‡∏•‡∏ú‡∏•‡∏¥‡∏ï‡∏ï‡πà‡∏≠‡∏≠‡∏≥‡πÄ‡∏†‡∏≠
   - **Pie Chart**: ‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå‡∏Ç‡πâ‡∏≤‡∏ß
   - **Geo Map**: ‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏≤‡∏∞‡∏õ‡∏•‡∏π‡∏Å
   - **Table**: ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡∏¥‡∏ö

### ‡∏´‡∏ô‡πâ‡∏≤ Dashboard ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥

**‡∏´‡∏ô‡πâ‡∏≤ 1: Overview**
- ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î
- ‡∏ú‡∏•‡∏ú‡∏•‡∏¥‡∏ï‡∏Ñ‡∏≤‡∏î‡∏Å‡∏≤‡∏£‡∏ì‡πå
- ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏∑‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Å‡∏±‡∏ö‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢

**‡∏´‡∏ô‡πâ‡∏≤ 2: ‡∏£‡∏≤‡∏¢‡∏≠‡∏≥‡πÄ‡∏†‡∏≠**
- Heatmap ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏≤‡∏∞‡∏õ‡∏•‡∏π‡∏Å
- Ranking ‡∏≠‡∏≥‡πÄ‡∏†‡∏≠‡∏ó‡∏µ‡πà‡∏õ‡∏•‡∏π‡∏Å‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î

**‡∏´‡∏ô‡πâ‡∏≤ 3: Timeline**
- ‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏≤‡∏∞‡∏õ‡∏•‡∏π‡∏Å 12 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô
- ‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏õ‡∏µ‡∏ï‡πà‡∏≠‡∏õ‡∏µ

---

## üõ†Ô∏è Troubleshooting

### ‚ùå ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ó‡∏µ‡πà‡∏û‡∏ö‡∏ö‡πà‡∏≠‡∏¢

#### 1. **"Apps Script API not enabled"**

**‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:**
```bash
# ‡πÄ‡∏õ‡∏¥‡∏î‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏ô‡∏µ‡πâ
https://script.google.com/home/usersettings
# ‡πÄ‡∏õ‡∏¥‡∏î "Google Apps Script API"
```

#### 2. **"Permission denied" ‡πÄ‡∏°‡∏∑‡πà‡∏≠ Deploy**

**‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:**
- ‡πÉ‡∏ô Apps Script Editor ‚Üí Deploy ‚Üí New deployment
- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å "Execute as: Me"
- Grant permissions

#### 3. **Rate Limit Error ‡πÅ‡∏°‡πâ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÉ‡∏ä‡πâ‡∏ö‡πà‡∏≠‡∏¢**

**‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:**
```javascript
// ‡∏•‡πâ‡∏≤‡∏á Cache (‡∏£‡∏±‡∏ô‡πÉ‡∏ô Apps Script)
function clearRateLimit() {
  CacheService.getScriptCache().removeAll(['ratelimit_*']);
  Logger.log('‚úÖ ‡∏•‡πâ‡∏≤‡∏á Rate Limit ‡πÅ‡∏•‡πâ‡∏ß');
}
```

#### 4. **AI ‡πÑ‡∏°‡πà‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö**

**‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö:**
1. API Key ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
2. Quota ‡∏¢‡∏±‡∏á‡∏û‡∏≠‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà (‡∏î‡∏π‡∏ó‡∏µ‡πà Google AI Studio)
3. ‡∏î‡∏π Logs: `clasp logs` ‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏ô Apps Script Editor ‚Üí Executions

#### 5. **‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏Ç‡∏∂‡πâ‡∏ô Dashboard**

**‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:**
- ‡∏£‡∏≠ 1-2 ‡∏ô‡∏≤‡∏ó‡∏µ (Google Sheets ‡∏°‡∏µ delay)
- Refresh Data Source ‡πÉ‡∏ô Looker Studio
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Headers ‡∏ß‡πà‡∏≤‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô‡∏ó‡∏±‡πâ‡∏á 2 ‡∏ù‡∏±‡πà‡∏á
  </script>

    <script>
      // Initialize Marked and Highlight.js
      marked.setOptions({
        gfm: true,
        breaks: true,
        highlight: function (code, lang) {
          const language = hljs.getLanguage(lang) ? lang : 'plaintext';
          return hljs.highlight(code, { language }).value;
        },
        langPrefix: 'hljs language-'
      });

      function showDoc(docId) {
        // Update Active Nav Item
        document.querySelectorAll('.nav-item').forEach(item => item.classList.remove('active'));

        // Find the nav item that corresponds to this docId
        const navItems = document.querySelectorAll('.nav-item');
        navItems.forEach(item => {
          if (item.getAttribute('onclick').includes(docId)) {
            item.classList.add('active');
          }
        });

        // Get Markdown Content from Script Tag
        const mdElement = document.getElementById('md-' + docId);
        if (!mdElement) {
          console.error('Markdown content not found for id: md-' + docId);
          return;
        }

        // Use textContent from script tag which preserves raw text
        const mdContent = mdElement.textContent;

        // Render Markdown
        const contentDiv = document.getElementById('content');
        contentDiv.innerHTML = marked.parse(mdContent);

        // Scroll to top
        document.querySelector('.main-content').scrollTop = 0;
      }

      // Load initial content
      window.onload = function () {
        // Load 'overview' by default
        showDoc('overview');

        // Intercept anchor clicks to prevent page reload (due to base target="_top")
        document.addEventListener('click', function (e) {
          const link = e.target.closest('a');
          if (link && link.getAttribute('href').startsWith('#')) {
            e.preventDefault();
            const id = link.getAttribute('href').substring(1);
            // Decode URI component to handle Thai characters
            const decodedId = decodeURIComponent(id);
            const element = document.getElementById(decodedId);
            if (element) {
              element.scrollIntoView({ behavior: 'smooth' });
            }
          }
        });
      };
    </script>
</body>

</html>